\chapter[EEGPSR in detail]{E\textsuperscript{2}GPSR in detail.}
\label{chap:eegpsr-appendix}

\section{Command Generation}
EEGPSR commands are generated randomly using the official [EE]GPSR Command Generator and grammars publicly available at https://github.com/kyordhel/GPSRCmdGen. The official [EE]GPSR Command Generator and the official grammars will be made available two months before the competition. However, teams must be aware that the categories, objects and other data is provided for testing purposes only.

For each command to be executed, the Team Leader must choose a Command Category. If the Team Leader knows \textit{a priori} that the robot won't be able to execute the generated command, is advised to inform the operator immediately in order to proceed with the next command, saving this way valuable time for the task execution.


\section{Command retrieval explained}
The robot has to show it has understood the given command by stating all the required information to accomplish the task. For this purpose, the robot may repeat the understood command and ask for confirmation. It is not required to repeat the command word by word; rephrasing the command is allowed. For instance, if the robot is instructed to \enquote{place a coke onto the tray}, the robot may either say: \textit{\enquote{You want me to place a coke on the tray. Is that correct?}} or \textit{\enquote{do you want me to deliver a coke to the tray?}}.

If The robot can't correctly recognize the given command, it is allowed to request the operator to repeat the command up to three times. After three failed attempts, a new command is generated. The team may opt to use a custom operator or bypassing speech recognition (\refsec{rule:asrcontinue}) at any time, but each generated command will be given to the robot no more than three times. Only three different commands are generated for a robot, if the robot fails to recognize all three commands (i.e.~nine attempts), the test ends immediately.

When a robot has partially understood the command, it is allowed to ask the operator for additional information (e.g.~\textit{\enquote{did you say apple juice or pineapple juice?}}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Categories explained
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Categories explained}
\label{sec:eegpsr-categories-explained}
This section explain each of the categories of the test and provides examples on how the abilities are scored.

It is important to remark that there is no script or predefined way to solve the tasks, being most of them of ambiguous nature. It is up to the team to choose how to solve each tasks accordingly with the robot's capabilities.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Category I explained
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Category I: Three at once}
\label{sec:eegpsr-category1-explained}
Command from this category are composed of \textit{three simple actions}, which the robot has to show it has recognized. The robot may repeat the understood command and ask for confirmation. If it can't recognize the command correctly, it can also ask the speaker to repeat the complete command.

Tasks from this category are much alike the ones in GPSR (see~\refsec{chap:gpsr-appendix-cat1} and~\refsec{chap:gpsr-appendix-cat2}), requiring to master basic skills. Since commands must be accomplished as quick as possible, in this category speed is the key.

\subsubsection{Command examples}
\begin{itemize}
	\item Go to the kitchen counter, take the coke, and bring it to me.
	\item Bring the chips to Mary at the sofa, tell the time and follow her.
	\item Find a person in the living room, guide them to the kitchen and follow them.
	\item Take the chips from the counter, find a person in the bedroom, and go to the entrance.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Category II explained
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Category II: People}
\label{sec:eegpsr-category2-explained}
Tasks from this category require memorizing a person's features, describing unknown people, recognize people from description, and find people from the distance; as well as following or guiding a person in crowded environments or through narrow spaces. The navigation may take place either inside or outside the arena.

\subsubsection{Task examples}
\begin{itemize}
	\item Describing a person in certain specific location.
	\item Delivering objects to a person that matches the given description.
	\item Reporting number of people in a room matching given description.
	\item Finding people performing certain activity.
	\item Finding people whose face or body or partially occluded or not facing the robot.
	\item Following a person inside an elevator.
	\item Guiding a person to the toilet.
	\item Going through a multitude while following or guiding a person without loosing them.
	\item Avoiding people crossing or standing by while guiding or following.
	\item Performing real time mapping and localization.
\end{itemize}

\subsubsection{Command examples}
\begin{itemize}
	\item Offer a beer to all the adults in the living room.
	\item Meet the person at the door. If their name is John guide him to the kitchen, ask him to leave otherwise.
	\item Guide the person at the entrance to the kitchen.
	\item Find John in the kitchen, he wearing black.
	\begin{itemize}
		\item[Kitchen:] Robot, follow me (goes outside to car).
		\item[Car:] Please ask Jerry and Jimmy at the sofa to help carrying out the groceries.
	\end{itemize}
	\item Describe the person at the door to the woman in the Kitchen.
	\item Take this coke to the girl [in the living room] wearing a red sweater.
	\item Tell me how many standing people there are in the dining room.
	\item Go to the living room and follow the waving person.
	\item Tell me what John is doing (John is reading a book).
\end{itemize}

\subsubsection{Meeting new people}
Say the generated command is \textit{ask Joe to come here}, since the robot has no knowledge of who is Joe, it is expected to ask \enquote{\textit{how can I recognize Joe?}} Two answers are possible:
\begin{itemize}
	\item \textbi{Meet Joe:} The person named \textit{Joe} will stand in front of the robot and follow robot's (not team's) instructions for training. The robot must announce when it has completed memorizing that person before proceeding to execute the command.
	\item \textbi{Joe is the...} A description indicating how to recognize \textit{Joe} is given to the robot. Retrieved information must be confirmed.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Category III explained
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Category III: Objects}
\label{sec:eegpsr-category3-explained}
Tasks from this category require handling objects into small or narrow spaces, opening doors and drawers, describing unknown objects, recognize objects from description, identify occluded objects and from the distance.

\subsubsection{Task examples}
\begin{itemize}
	\item Setting up a table.
	\item Cleaning up spots or spills.
	\item Grasping objects from a box.
	\item Placing objects into a microwave or fridge.
	\item Transporting a tray.
	\item Pouring cereal in a bowl.
	\item Retrieving objects from a given description.
	\item Counting and describing objects.
	\item Finding objects from distance or inside drawers.
\end{itemize}

\subsubsection{Command examples}
\begin{itemize}
	\item Hand me a coke from the fridge (the coke is inside the fridge).
	\item Bring me some flakes in a bowl.
	\item Put this book into the drawer.
	\item Bring me the biggest pill bottle from the kitchen counter.
	\item Bring me the bookcase's right-most object.
	\item Describe the objects on the drawer to me.
	\item Tell me how many red apples are in the basket on the kitchen table.
	\item Count the snacks in the shelf and tell me how many there are.
	\item Set up the table and serve some toasts.
\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Scenarios explained
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Scenarios explained}
\label{sec:eegpsr-categories-explained}
A different scenario applies to each randomly generated command in the category chosen by the team. The scenario is chosen by the referees in a semi-random fashion so all the robots try all three scenarios described below.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Scenario: incomplete information
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Incomplete commands}
\label{sec:eegpsr-incomplete-command}
The commands given do not include all the information necessary to accomplish the task. The actual commands are under-specified by, for example:
\begin{itemize}
	\item only giving the class of the object (\enquote{bring me a drink}) or location (\enquote{guide me to the table}), and not the actual object or location, or
	\item not providing the location (or its class).
\end{itemize}

The robot can ask questions to retrieve the missing information about the task, but is not required to. In the questions the robot has to make clear what it has already understood, e.g., tell the operator that it has understood \textit{to bring a particular beverage can}, but not \textit{where the can is} located in the arena. The robot may also simply start searching.

\subsubsection{Examples}
\begin{itemize}
	\item Go to the kitchen counter, take the drink, and bring it to me (unspecified which drink).
	\item Find a person, guide them to the kitchen and follow them (unspecified where the person can be found).
	\item Bring me some drink in a bowl (unspecified which drink).
	\item Put the biggest pill bottle in kitchen counter on the table (unspecified table).
	\item Offer them a beer (unspecified to who and where are they).
	\item Guide Joe here (unspecified where is Joe and how to recognize him).
\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Scenario: erroneous and misleading information
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Erroneous and misleading commands}
\label{sec:eegpsr-erroneous-command}
The robot gets a command that contains erroneous information. The robot should be able to realize such an error while trying to carry out the task, and try to carry on an alternative solution. If the robot is unable to solve the problem, it must go back to the operator, and clearly state \textit{why} it wasn't able to accomplish the task.

If on the contrary the robot was able to solve the task, it also must explain what went wrong and how it was solved.

\subsubsection{Examples}
Below some examples are presented. For each example command, one or more possible problems are depicted.
\begin{itemize}
	\item Set up the table (and serve some choco flakes).
	\begin{itemize}
		\item The cuttlery is in another drawer in cupboard.
		\item Choco-flakes box is empty, but there are normal flakes.
	\end{itemize}

	\item Bring to Ana at the coach the water from the cupboard.
	\begin{itemize}
		\item The water is on the dinner table.
		\item Ana is lying on the bed.
	\end{itemize}

	\item Find James in the living room and guide him to the car.
	\begin{itemize}
		\item James is in the bedroom.
		\item James is lying unconscious in the living room's floor.
	\end{itemize}
\end{itemize}

\section{Bypassing commands and alternate solutions}
The EEGPSR is a goal-driven test in which the final results has priority over how the command is executed.
This adds several degrees of freedom to make a plan and execute a command accordingly with the robot's capabilities.

For instance, consider the following command:

\begin{center}
\noindent\textit{Bring me a coke}
\end{center}

It is clear that the operator wants a coke and cares little about how the coke is retrieved. Now, let's say that the robot's manipulator is broken, so it won't be able to handle a coke. In this case, several scenarios become evident:

\begin{itemize}
	\item \textbf{Skipping command:} The robot says \enquote{I understood you want me to bring you a coke, but I cannot grasp objects, so I'll skip this command}. Since the robot is not executing the task, no score is given.

	\item \textbf{Continue Rule:} The robot more or less reaches the position, fuzzily points at the object, and then requests to a human assistant to deliver the coke for it. In this case, the referee might grant up to $\frac{1}{3}$ of the points, if any.

	\item \textbf{Requesting human assistance:} Taking advantage of the Continue Rule, the robot requests assistance from a human to grasp the object, requesting later to follow it. During the guiding phase, the robot actively tracks the human to the operator's position and supervises the delivery (e.g.~telling it noticed the operator has received the coke). In this case, and regarding the execution of the tasks, the referee may grant a full score.

	\item \textbf{Social alternative:} The robot looks for another person in the arena, finds them, and convinces them (or socially bribes them) to deliver a coke to the operator using natural language dialogs. In these rare cases, the referee may grant a full score depending on the success of the interaction.
\end{itemize}

